# 编译原理作业2

**姓名：孙铎**

**学号：200110503**

## 第5章

课本第5章第15题；

![image-20221109212240810](homework2.assets/image-20221109212240810.png)

（1）：

开始符号`S`只出现在产生式`S -> A`的左部，符合**只有一个接收状态**的要求，所以不使用增广文法。

产生式编号为：

1.   `S -> A`
2.   `A -> BA`
3.   `A -> ε`
4.   `B -> aB`
5.   `B -> b`

需要的FIRST集：

-   `FIRST(A)={ε,a,b}`

文法G的LR(1)自动机/项目集为：

```mermaid
graph LR
	0["I0<br>S -> ●A, #<br>A -> ●BA, #<br>A -> ●, #<br>B -> ●aB, #/a/b<br>B -> ●b, #/a/b"]
	1["I1<br>S -> A●, #"]
	2["I2<br>A -> B●A, #<br>A -> ●BA, #<br>A -> ●, #<br>B -> ●aB, #/a/b<br>B -> ●b, #/a/b"]
	3["I3<br>B -> a●B, #/a/b<br>B -> ●aB, #/a/b<br>B -> ●b, #/a/b"]
	4["I4<br>B -> b●, #/a/b"]
	5["I5<br>A -> BA●, #<br>"]
	6["I6<br>B -> aB●, #/a/b"]
	0--A-->1
	0--B-->2
	0--a-->3
	0--b-->4
	2--A-->5
	2--B-->2
	2--a-->3
	2--b-->4
	3--B-->6
	3--a-->3
	3--b-->4
```

（2）：

构造G的LR(1)分析表：

![image-20221111113822002](homework2.assets/image-20221111113822002.png)

（3）：

输入符号串`w=abab`的自底向上语法分析过程为：

| 状态栈(栈底$\rarr$栈顶) | 符号栈(栈底$\rarr$栈顶) | 输入缓冲(自左向右读取) | ACTION | GOTO |
| :---------------------: | :---------------------: | :--------------------: | :----: | :--: |
|            0            |            #            |         abab#          |   s3   |      |
|           03            |           #a            |          bab#          |   s4   |      |
|           034           |           #ab           |          ab#           |   r5   |  6   |
|           036           |           #aB           |          ab#           |   r4   |  2   |
|           02            |           #B            |          ab#           |   s3   |      |
|           023           |           #Ba           |           b#           |   s4   |      |
|          0234           |          #Bab           |           #            |   r5   |  6   |
|          0236           |          #BaB           |           #            |   r4   |  2   |
|           022           |           #BB           |           #            |   r3   |  5   |
|          0225           |          #BBA           |           #            |   r2   |  5   |
|           025           |           #BA           |           #            |   r2   |  1   |
|           01            |           #A            |           #            |  acc   |      |



## 第7章

课本第7章第22题第（1）小题；

<img src="homework2.assets/image-20221109225303022.png" alt="image-20221109225303022" style="zoom:60%;" />

语句的三地址码为：

1.   `if a < c goto 3`
2.   `goto 15`
3.   `if b < d goto 5`
4.   `goto 15`
5.   `if a = 1 goto 7`
6.   `goto 10`
7.   `t1 := c + 1`
8.   `c := t1`
9.   `goto 1`
10.   `if a <= d goto 12`
11.   `goto 1`
12.   `t2 := a + 2`
13.   `a := t2`
14.   `goto 10`
15.   

对应的四元式序列为：

1.   `(j<, a, c, 3)`
2.   `(j, -, -, 15)`
3.   `(j<, b, d, 5)`
4.   `(j, -, -, 15)`
5.   `(j=, a, 1, 7)`
6.   `(j, -, -, 10)`
7.   `(=, c, 1, t1)`
8.   `(=, t1, -, c)`
9.   `(j, -, -, 1)`
10.   `(j<=, a, d, 12)`
11.   `(j, -, -, 1)`
12.   `(=, a, 2, t2)`
13.   `(=, t2, -, a)`
14.   `(j, -, -, 10)`
15.   

## 第9章

课本第9章第8题；

![image-20221109225426575](homework2.assets/image-20221109225426575.png)

由地址空间分配策略可知：

因为`short`类型要对齐到2的倍数，且`sizeof(short)`为2，所以：

-   `a.i`占用的相对地址为`0~1`
-   `a.j`占用的相对地址为`2~3`
-   `a.k`占用的相对地址为`4~5`

又因为`long`类型要对齐到4的倍数，且`sizeof(long)`为4，所以：

-   `b.i`占用的相对地址为`8~11`
-   `b.k`占用的相对地址为`12~13`

所以`b`整体占用的相对地址应当是`6~13`，所以类型b的长度等于8

## 第11章

课本第11章第2题；

<img src="homework2.assets/image-20221109225511673.png" alt="image-20221109225511673" style="zoom:60%;" /><img src="homework2.assets/image-20221109225521717.png" alt="image-20221109225521717" style="zoom:60%;" />

（1）**总开销为7**

-   `MOV y, R0`：开销为2

    `MOV`指令本身开销为1，再加上存储变量`y`地址的开销1，寄存器不需要额外开销

-   `MOV z, R1`：开销为2

    `MOV`指令本身开销为1，再加上存储变量`z`地址的开销1，寄存器不需要额外开销

-   `ADD R1, R0`：开销为1

    `ADD`指令本身开销为1，寄存器不需要额外开销

-   `MOV R0, x`：开销为2

    `MOV`指令本身开销为1，再加上存储变量`x`地址的开销1，寄存器不需要额外开销

（2）**总开销为8**

-   `MOV i, R0`：开销为2

    `MOV`指令本身开销为1，再加上存储变量`i`地址的开销1，寄存器不需要额外开销

-   `MUL 8, R0`：开销为2

    `MOV`指令本身开销为1，再加上存储立即数8的开销1，寄存器不需要额外开销

-   `MOV a(R0), R1`：开销为2

    `MOV`指令本身开销为1，再加上存储变量`a`地址的开销1，寄存器不需要额外开销

-   `MOV R1, b`：开销为2

    `MOV`指令本身开销为1，再加上存储变量`b`地址的开销1，寄存器不需要额外开销

（3）**总开销为6**

-   `MOV p, R0`：开销为2

    `MOV`指令本身开销为1，再加上存储变量`p`地址的开销1，寄存器不需要额外开销

-   `MOV 0(R0), R1`：开销为2

    `MOV`指令本身开销为1，再加上存储立即数0的开销1，寄存器不需要额外开销

-   `MOV R1, x`：开销为2

    `MOV`指令本身开销为1，再加上存储变量`x`地址的开销1，寄存器不需要额外开销

（4）**总开销为6**

-   `MOV x, R0`：开销为2

    `MOV`指令本身开销为1，再加上存储变量`x`地址的开销1，寄存器不需要额外开销

-   `MOV y, R1`：开销为2

    `MOV`指令本身开销为1，再加上存储变量`y`地址的开销1，寄存器不需要额外开销

-   `SUB R1, R0`：开销为1

    `SUB`指令本身开销为1，寄存器不需要额外开销

-   `MOV R0, *R3`：开销为1

    `MOV`指令本身开销为1，寄存器不需要额外开销

