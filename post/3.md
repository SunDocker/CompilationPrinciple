## 3 词法分析

### 3.1 正则表达式

-   正则表达式是描述**正则语言**的**更紧凑**的表示方法，它可以**递归构建**

-   与**正则文法、有穷自动机**等价

    >   正则表达式很**简洁**；
    >
    >   正则文法方便文法**性质**的证明；
    >
    >   有穷自动机没那么抽象，方便**实现**；

-   有自己的**代数定律**

### 3.2 有穷自动机

>   核心就是：`状态 + 输入 + 转换`

-   有穷自动机（FA）：
    -   一种处理系统的数学模型。这种处理系统由**输入带、读头、有穷控制器**构造，可以根据当前**状态**和**输入**转入下一状态。
    -   FA有其定义/接收的**语言**
    -   FA遵循最长子串匹配

-   DFA：一种代表FA模型的**五元组**
    -   **有穷状态集**（S）
    -   **输入字母表**（$\Sigma$）
        >   $\epsilon\notin\Sigma$
    -   **转换函数**（$\sigma$）：$S\times\Sigma\rarr S$
    -   **开始状态**（$s_0$）
    -   **接收状态集合**（$F$）

-   NFA：一种代表FA模型的**五元组**
    -   **有穷状态集**（$S$）
    
    -   **输入字母表**（$\Sigma$）
    
    -   **转换函数**（$\sigma$）：$S\times\Sigma\rarr 2^S$
    
        >   $\epsilon-NFA$与$NFA$的区别就在于转换函数：$S\times(\Sigma\cup\{\epsilon\})\rarr 2^S$
    
    -   **开始状态**（$s_0$）
    
    -   **接收状态集合**（$F$）

### 3.3 RE与FA的转换

-   $RE\rarr NFA$：**分解、递归**
    -   RE与NFA的对应规则

-   $NFA\rarr DFA $：**状态转换表**
    -   子集构造法

### 3.4 词法单元token

-   概念：
    -    词法单元token是源程序中**单词的机内表示**，由**种别码和属性值**构成

-   种别码：
    -    记录单词**类型**

    -   一词一码：关键字、运算符、界限符
    -   一型一码：常量、运算符
    -   多词一码：标识符

-   属性值：
    -    记录单词**字面值**

    -   一词一码：**不需要属性值**
    -   一型一码：用**属性值区分**同一类型的单词
    -   多词一码：用属性值记录**无法枚举**的标识符字面值

### 3.5 词法分析器

-   词法分析器的功能
    -   词法分析器扫描源程序字符串，识别**单词**，确定类型，生成单词(***token***)串
        -   根据**词法规则**识别及组合单词，进行词法检查
        -   对**数字**常数完成数字字符串到**二进制数值**的转换
        -   预处理：删去**空格**字符和**注释**
            >   给人看的，对**机器**无意义

-   词法分析器的工作
    -   输入缓冲区（Look ahead）：设置一个单词开始指针和扫描指针，**一前一后**，中间的部分是要识别的单词
    -   识别出关键字后需要登记符号表

### 3.6 词法分析阶段的错误处理

-   错误类型
    -   **单词拼写**错误
    -   **非法字符**
    -   不封闭
    -   重复声明

-   错误恢复与续编译：错误处理程序
    -   调用时机：**当前状态与当前输入信息为空**
    -   处理方式：查找已扫描字符串的最后一个**终态字符**
        >   终态指的是自动机终态

        -   找到了：识别成一个**单词**，回到初态
        -   没找到：错误恢复策略（**恐慌模式**）
    -   恐慌模式：从**剩余输入中删除字符**直到遇到正确字符

